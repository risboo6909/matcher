# matcher

Реализовать систему сведения заявок для рынка – матчер.

Заявка обладает следующими свойствами:

    Сторона (side) - покупка или продажа
    Лимит цены (price: u64) – купить не дороже / продать не дешевле
    Количество покупаемого товара (size: u64)
    User ID (u64)
    Тип (см. ниже)

Заявки бывают трех типов:

    Limit – исполняется полностью или частично и остаток ставится в очередь на исполнение. Если нет возможности исполнить в момент поступления, то ставится в очередь во всем объеме.
    Fill or kill – исполнить все или ничего. Если в очереди (стакан) есть суммарное кол-во заявок с ценой удовлетворяющей запрошенную, то такая заявка удовлетворяется. Иначе – отменяется (не добавляется в очередь). По такой заявке невозможно частичное исполнение.
    Immediate or cancel – исполняется любая часть такой заявки, а остальное отменяется (не ставится в очередь). Таким образом различают входящие и пассивные заявки. Входящая – обслуживаемая в данный момент. Пассивные – обслуженные ранее и поставленные в очередь на исполнение. Пассивными бывают только Limit. Входящая заявка может быть сведена с несколькими пассивными. Заявки от одного пользователя не сводятся между собой.

Система должна уметь принимать на вход (файл) заявки и подавать на выход (stdout) результаты матчинга – постановку в очередь, исполнение, отмена. Заявки обрабаытываются в соответствии с приоритетом (цена, FIFO). Т.е. сначала наиболее привлекательные с точки зрения цены (купить подешевле, продать подороже), а затем порядок. Частичное исполнения - часть одной заявки полностью удовлетворяет другую заявку. Стаканом называется очереди на обслуживание в определенный момент.

Необходимо разработать структуру и алгоритм матчинга ориентируясь на скорость сведения. Написать бенчмарк (использовать criterion) для определения скорости работы матчера для входящей заявки, которая сводится с 20 пассивными заявками из очереди в 7000.
